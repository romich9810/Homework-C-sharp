using System;
using System.Collections.Generic;
using System.Diagnostics.Eventing.Reader;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace _4_1_dossier
{
    internal class Program
    {
        static void Main(string[] args)
        {
            const string AddToDossier = "добавить досье";
            const string ShowAllDossiers = "вывести все досье";
            const string DeleteToDossier = "удалить досье";
            const string SearchingBySurname = "поиск по фамилии";
            const string Exit = "выход";
            const string NumberAddDossier = "1";
            const string NumberShowAllDossiers = "2";
            const string NumberDeleteDossier = "3";
            const string NumberSearchingBySurname = "4";
            const string NumberExit = "5";

            bool isWorking = true;

            string[] nameSurnames = new string[0];
            string[] posts = new string[0];
            string commandFromUser;

            while (isWorking)
            {
                Console.WriteLine("***Добро пожаловать в редактор досье!***\n\nВыберите команду: ");
                Console.Write($"{NumberAddDossier} - {AddToDossier}\n{NumberShowAllDossiers} - {ShowAllDossiers}\n" +
                    $"{NumberDeleteDossier} - {DeleteToDossier}\n{NumberSearchingBySurname} - {SearchingBySurname}\n{NumberExit} - {Exit}\n");
                commandFromUser = Console.ReadLine();

                switch (commandFromUser)
                {
                    case NumberAddDossier:
                        AddDossier(ref nameSurnames, ref posts);
                        break;

                    case NumberShowAllDossiers:
                        ShowDossiers(nameSurnames, posts);
                        break;

                    case NumberDeleteDossier:
                        DeleteDossier(ref nameSurnames, ref posts);
                        break;

                    case NumberSearchingBySurname:
                        FindBySurname(nameSurnames, posts);
                        break;

                    case NumberExit:
                        isWorking = false;
                        Console.Write("Завершение работы программы.");
                        break;

                    default:
                        Console.WriteLine("Неверная команда. Попробуйте ещё раз.");
                        break;
                }
            }
        }

        static void AddDossier(ref string[] massiveNames, ref string[] massivePosts)
        {
            const string NumberAddAgain = "1";
            const string CommandAddAgain = "добавить ещё";
            const string CommandBack = "любая клавиша - к главному меню";

            string command;
            bool isNeedContune = true;

            while (isNeedContune == true)
            {
                Console.Clear();
                Console.WriteLine("***ФИО cотрудников***\n");

                Console.Write("ФИО сотрудника. ");
                ExpandMassive(ref massiveNames);

                Console.Write("Должность сотрудника. ");
                ExpandMassive(ref massivePosts);

                Console.Clear();
                Console.WriteLine($"Данные успешно внесены.\n{CommandBack}\n{NumberAddAgain} - {CommandAddAgain}");
                command = Console.ReadLine();

                if (command != NumberAddAgain)
                {
                    isNeedContune = false;
                }
            }

            Console.Clear();
        }

        static void ExpandMassive(ref string[] massive)
        {
            string[] temporaryMassive = new string[massive.Length + 1];

            for (int j = 0; j < massive.Length; j++)
            {
                temporaryMassive[j] = massive[j];
            }

            Console.Write("Введите данные:");
            temporaryMassive[temporaryMassive.Length - 1] = Console.ReadLine();
            massive = temporaryMassive;
        }

        static void ShowDossiers(string[] massiveNames, string[] massivePosts)
        {
            Console.WriteLine("Все имеющиеся досье:\n");

            for (int i = 0; i < massiveNames.Length; i++)
            {
                Console.WriteLine($"{i + 1}) {massiveNames[i]} - {massivePosts[i]}");
            }

            Console.WriteLine("Для возвращения нажмите любую клавишу.");
            Console.ReadKey();
            Console.Clear();
        }

        static void DeleteDossier(ref string[] massiveNames, ref string[] massivePosts)
        {
            int indexFromUserForDeleting;
            int indexForDeleting;

            ShowDossiers(massiveNames, massivePosts);
            Console.WriteLine("Введите индекс для удаления досье: ");

            if (int.TryParse(Console.ReadLine(), out indexFromUserForDeleting))
            {
                indexForDeleting = indexFromUserForDeleting - 1;

                MoveElemetToEndMassive(ref massiveNames, indexForDeleting);
                MoveElemetToEndMassive(ref massivePosts, indexForDeleting);

                DeleteLastElementFromMassive(ref massiveNames);
                DeleteLastElementFromMassive(ref massivePosts);

                Console.WriteLine("\nПосле удаления:");
                ShowDossiers(massiveNames, massivePosts);
            }
            else
            {
                Console.WriteLine("Неверное значение индекса.");
                Console.ReadKey();
            }

            Console.Clear();
        }

        static void MoveElemetToEndMassive(ref string[] massive, int indexForMoving)
        {
            string temporaryMember;

            for (int i = indexForMoving; i < massive.Length - 1; i++)
            {
                temporaryMember = massive[i + 1];
                massive[i + 1] = massive[i];
                massive[i] = temporaryMember;
            }
        }

        static void DeleteLastElementFromMassive(ref string[] massive)
        {
            string[] temporaryMassive = new string[massive.Length - 1];

            for (int i = 0; i < temporaryMassive.Length; i++)
            {
                temporaryMassive[i] = massive[i];
            }

            massive = temporaryMassive;
        }

        static void FindBySurname(string[] massiveNames, string[] massivePosts)
        {
            char divider = ' ';
            string[] potentialMatchingWords;
            string surname;
            bool isThereSurnameInMassive = false;

            Console.WriteLine("Введите фамилию для поиска");
            surname = Console.ReadLine();

            for (int i = 0; i < massiveNames.Length; i++)
            {
                potentialMatchingWords = massiveNames[i].Split(divider);

                if (potentialMatchingWords[0] == surname) 
                {
                    Console.WriteLine($"Такое досье есть!Вот оно:\n{massiveNames[i]} - {massivePosts[i]}");
                    isThereSurnameInMassive = true;
                }
            }

            if (isThereSurnameInMassive == false)
            {
                Console.WriteLine("Такой фамилии не найдено! Нажмите любую клавишу, чтобы продолжить.");
                Console.ReadKey();
            }

            Console.Clear();
        }
    }
}
